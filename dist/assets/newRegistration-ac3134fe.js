import{r as l,j as t}from"./react-472d7f6d.js";import{a as p}from"./axios-439bb627.js";import{P as C,T as S,G as c,B as d,S as w,a as T}from"./@mui-0a0ea82a.js";import"./hoist-non-react-statics-d052b204.js";import"./clsx-5a9f8d06.js";import"./@emotion-94b9ecb4.js";import"./@babel-591e0485.js";import"./stylis-79144faa.js";import"./react-transition-group-ffe54232.js";import"./react-dom-4df14f11.js";import"./scheduler-765c72db.js";const q=()=>{const[e,h]=l.useState({id:"",name:"",phone:"",emergencyContactName:"",emergencyContactNumber:"",height:"",weight:"",age:"",bloodGroup:"",email:"",address:""}),[m,g]=l.useState(null),[u,n]=l.useState(""),[x,i]=l.useState(!1),f=s=>{const{name:r,value:o}=s.target;h({...e,[r]:o})},b=()=>e.email.includes("@")?isNaN(e.phone)||e.phone.length<10?(n("Phone number must be at least 10 digits."),i(!0),!1):!e.id||!e.name||!e.address?(n("Please fill in all required fields."),i(!0),!1):!0:(n("Invalid email address."),i(!0),!1),y=async()=>{try{const s="https://localhost:5000",r=await p.get(`${s}/capture-rtsp`);if(r.data&&r.data.image)g(`data:image/jpeg;base64,${r.data.image}`);else throw new Error("No image data received")}catch(s){n(`Error capturing image from RTSP stream: ${s.message}`),i(!0)}},j=()=>{g(null)},N=async s=>{if(s.preventDefault(),!!b())try{const r="https://localhost:5000",o=await p.post(`${r}/new-registration`,{...e,image:m});console.log("Form submitted successfully:",o.data),n("Registration successful!"),i(!1),setTimeout(()=>{n("")},2e3)}catch(r){console.error("Error submitting form:",r),n("Error submitting registration. Please try again."),i(!0)}},a=(s,r,o,v="text")=>t.jsx(T,{fullWidth:!0,label:s,name:r,value:o,onChange:f,variant:"outlined",margin:"normal",type:v,required:!0});return t.jsxs("div",{className:"flex flex-row min-h-screen",children:[t.jsxs("div",{className:"flex flex-col w-4/6 p-8",children:[t.jsxs("div",{className:"flex flex-row items-center justify-center mb-4",children:[t.jsx(C,{sx:{fontSize:50,color:"#007FFF"}}),t.jsx(S,{variant:"h4",className:"font-bold ml-2",children:"New Registration Form"})]}),t.jsxs("form",{onSubmit:N,children:[t.jsxs(c,{container:!0,spacing:2,children:[t.jsxs(c,{item:!0,xs:12,md:6,children:[a("ID","id",e.id),a("Phone","phone",e.phone,"tel"),a("Blood Group","bloodGroup",e.bloodGroup),a("Height","height",e.height,"number"),a("Email Address","email",e.email,"email")]}),t.jsxs(c,{item:!0,xs:12,md:6,children:[a("Name","name",e.name),a("Address","address",e.address),a("Age","age",e.age,"number"),a("Weight","weight",e.weight,"number"),a("Emergency Contact Name","emergencyContactName",e.emergencyContactName),a("Emergency Contact Number","emergencyContactNumber",e.emergencyContactNumber,"tel")]})]}),t.jsx(d,{variant:"contained",color:"primary",onClick:y,style:{marginTop:"20px"},children:"Capture Image from RTSP Stream"}),m&&t.jsx(d,{variant:"contained",color:"secondary",onClick:j,style:{marginTop:"10px"},children:"Retake Image"}),m&&t.jsx("div",{style:{marginTop:"20px"},children:t.jsx("img",{src:m,alt:"Captured from RTSP",style:{width:"100%",height:"auto"}})}),t.jsx(d,{type:"submit",variant:"contained",color:"primary",startIcon:t.jsx(w,{}),style:{marginTop:"20px"},children:"Submit"})]})]}),u&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-800 bg-opacity-75 z-50",children:t.jsx("div",{className:`p-6 rounded-lg text-center ${x?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:t.jsx("p",{className:"text-lg font-bold mb-4",children:u})})})]})};export{q as default};
